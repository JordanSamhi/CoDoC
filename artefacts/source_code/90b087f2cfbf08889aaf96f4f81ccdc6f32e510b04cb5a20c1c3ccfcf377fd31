public static byte[] encode(BearerData bData){
    bData.hasUserDataHeader = ((bData.userData != null) && (bData.userData.userDataHeader != null));
    try {
        BitwiseOutputStream outStream = new BitwiseOutputStream(200);
        outStream.write(8, SUBPARAM_MESSAGE_IDENTIFIER);
        encodeMessageId(bData, outStream);
        if (bData.userData != null) {
            outStream.write(8, SUBPARAM_USER_DATA);
            encodeUserData(bData, outStream);
        }
        if (bData.callbackNumber != null) {
            outStream.write(8, SUBPARAM_CALLBACK_NUMBER);
            encodeCallbackNumber(bData, outStream);
        }
        if (bData.userAckReq || bData.deliveryAckReq || bData.readAckReq || bData.reportReq) {
            outStream.write(8, SUBPARAM_REPLY_OPTION);
            encodeReplyOption(bData, outStream);
        }
        if (bData.numberOfMessages != 0) {
            outStream.write(8, SUBPARAM_NUMBER_OF_MESSAGES);
            encodeMsgCount(bData, outStream);
        }
        if (bData.validityPeriodRelativeSet) {
            outStream.write(8, SUBPARAM_VALIDITY_PERIOD_RELATIVE);
            encodeValidityPeriodRel(bData, outStream);
        }
        if (bData.privacyIndicatorSet) {
            outStream.write(8, SUBPARAM_PRIVACY_INDICATOR);
            encodePrivacyIndicator(bData, outStream);
        }
        if (bData.languageIndicatorSet) {
            outStream.write(8, SUBPARAM_LANGUAGE_INDICATOR);
            encodeLanguageIndicator(bData, outStream);
        }
        if (bData.displayModeSet) {
            outStream.write(8, SUBPARAM_MESSAGE_DISPLAY_MODE);
            encodeDisplayMode(bData, outStream);
        }
        if (bData.priorityIndicatorSet) {
            outStream.write(8, SUBPARAM_PRIORITY_INDICATOR);
            encodePriorityIndicator(bData, outStream);
        }
        if (bData.alertIndicatorSet) {
            outStream.write(8, SUBPARAM_ALERT_ON_MESSAGE_DELIVERY);
            encodeMsgDeliveryAlert(bData, outStream);
        }
        if (bData.messageStatusSet) {
            outStream.write(8, SUBPARAM_MESSAGE_STATUS);
            encodeMsgStatus(bData, outStream);
        }
        if (bData.serviceCategoryProgramResults != null) {
            outStream.write(8, SUBPARAM_SERVICE_CATEGORY_PROGRAM_RESULTS);
            encodeScpResults(bData, outStream);
        }
        if (bData.msgCenterTimeStamp != null) {
            outStream.write(8, SUBPARAM_MESSAGE_CENTER_TIME_STAMP);
            encodeMsgCenterTimeStamp(bData, outStream);
        }
        return outStream.toByteArray();
    } catch (BitwiseOutputStream.AccessException ex) {
        Rlog.e(LOG_TAG, "BearerData encode failed: " + ex);
    } catch (CodingException ex) {
        Rlog.e(LOG_TAG, "BearerData encode failed: " + ex);
    }
    return null;
}