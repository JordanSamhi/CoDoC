public static void maskRawAddress(byte[] array, int prefixLength){
    if (prefixLength < 0 || prefixLength > array.length * 8) {
        throw new RuntimeException("IP address with " + array.length + " bytes has invalid prefix length " + prefixLength);
    }
    int offset = prefixLength / 8;
    int remainder = prefixLength % 8;
    byte mask = (byte) (0xFF << (8 - remainder));
    if (offset < array.length)
        array[offset] = (byte) (array[offset] & mask);
    offset++;
    for (; offset < array.length; offset++) {
        array[offset] = 0;
    }
}