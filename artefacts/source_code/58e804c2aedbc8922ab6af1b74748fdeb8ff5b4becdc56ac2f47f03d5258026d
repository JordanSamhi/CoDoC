public void ensureImeVisible(boolean visible){
    mPopup.setInputMethodMode(visible ? ListPopupWindow.INPUT_METHOD_NEEDED : ListPopupWindow.INPUT_METHOD_NOT_NEEDED);
    if (mPopup.isDropDownAlwaysVisible() || (mFilter != null && enoughToFilter())) {
        showDropDown();
    }
}