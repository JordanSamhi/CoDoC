public boolean getChildVisibleRect(View child, Rect r, android.graphics.Point offset, boolean forceParentCheck){
    final RectF rect = mAttachInfo != null ? mAttachInfo.mTmpTransformRect : new RectF();
    rect.set(r);
    if (!child.hasIdentityMatrix()) {
        child.getMatrix().mapRect(rect);
    }
    final int dx = child.mLeft - mScrollX;
    final int dy = child.mTop - mScrollY;
    rect.offset(dx, dy);
    if (offset != null) {
        if (!child.hasIdentityMatrix()) {
            float[] position = mAttachInfo != null ? mAttachInfo.mTmpTransformLocation : new float[2];
            position[0] = offset.x;
            position[1] = offset.y;
            child.getMatrix().mapPoints(position);
            offset.x = Math.round(position[0]);
            offset.y = Math.round(position[1]);
        }
        offset.x += dx;
        offset.y += dy;
    }
    final int width = mRight - mLeft;
    final int height = mBottom - mTop;
    boolean rectIsVisible = true;
    if (mParent == null || (mParent instanceof ViewGroup && ((ViewGroup) mParent).getClipChildren())) {
        rectIsVisible = rect.intersect(0, 0, width, height);
    }
    if ((forceParentCheck || rectIsVisible) && (mGroupFlags & CLIP_TO_PADDING_MASK) == CLIP_TO_PADDING_MASK) {
        rectIsVisible = rect.intersect(mPaddingLeft, mPaddingTop, width - mPaddingRight, height - mPaddingBottom);
    }
    if ((forceParentCheck || rectIsVisible) && mClipBounds != null) {
        rectIsVisible = rect.intersect(mClipBounds.left, mClipBounds.top, mClipBounds.right, mClipBounds.bottom);
    }
    r.set((int) Math.floor(rect.left), (int) Math.floor(rect.top), (int) Math.ceil(rect.right), (int) Math.ceil(rect.bottom));
    if ((forceParentCheck || rectIsVisible) && mParent != null) {
        if (mParent instanceof ViewGroup) {
            rectIsVisible = ((ViewGroup) mParent).getChildVisibleRect(this, r, offset, forceParentCheck);
        } else {
            rectIsVisible = mParent.getChildVisibleRect(this, r, offset);
        }
    }
    return rectIsVisible;
}