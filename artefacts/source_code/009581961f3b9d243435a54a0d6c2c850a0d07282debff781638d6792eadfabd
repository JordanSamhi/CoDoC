public long getRunRange(int offset){
    int line = getLineForOffset(offset);
    Directions dirs = getLineDirections(line);
    if (dirs == DIRS_ALL_LEFT_TO_RIGHT || dirs == DIRS_ALL_RIGHT_TO_LEFT) {
        return TextUtils.packRangeInLong(0, getLineEnd(line));
    }
    int[] runs = dirs.mDirections;
    int lineStart = getLineStart(line);
    for (int i = 0; i < runs.length; i += 2) {
        int start = lineStart + runs[i];
        int limit = start + (runs[i + 1] & RUN_LENGTH_MASK);
        if (offset >= start && offset < limit) {
            return TextUtils.packRangeInLong(start, limit);
        }
    }
    return TextUtils.packRangeInLong(0, getLineEnd(line));
}