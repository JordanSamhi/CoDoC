public static Intent rebuildManagedQuickContactsIntent(String lookupKey, long contactId, boolean isContactIdIgnored, long directoryId, Intent originalIntent){
    final Intent intent = new Intent(ACTION_QUICK_CONTACT);
    Uri uri = null;
    if (!TextUtils.isEmpty(lookupKey)) {
        uri = isContactIdIgnored ? Uri.withAppendedPath(Contacts.CONTENT_LOOKUP_URI, lookupKey) : Contacts.getLookupUri(contactId, lookupKey);
    }
    if (uri != null && directoryId != Directory.DEFAULT) {
        uri = uri.buildUpon().appendQueryParameter(ContactsContract.DIRECTORY_PARAM_KEY, String.valueOf(directoryId)).build();
    }
    intent.setData(uri);
    intent.setFlags(originalIntent.getFlags() | Intent.FLAG_ACTIVITY_NEW_TASK);
    intent.setSourceBounds(originalIntent.getSourceBounds());
    intent.putExtra(EXTRA_MODE, originalIntent.getIntExtra(EXTRA_MODE, MODE_DEFAULT));
    intent.putExtra(EXTRA_EXCLUDE_MIMES, originalIntent.getStringArrayExtra(EXTRA_EXCLUDE_MIMES));
    return intent;
}