public int closestIndexOnOrBefore(long time){
    final int index = closestIndexOnOrAfter(time);
    if (index < 0) {
        return size() - 1;
    }
    if (keyAt(index) == time) {
        return index;
    }
    return index - 1;
}