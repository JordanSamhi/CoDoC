public void writeToParcel(final Parcel dest){
    if (mCount == 0) {
        dest.writeInt(mCount);
        return;
    }
    byte[] compressedData = mCompressedData;
    int decompressedSize = mDecompressedSize;
    if (compressedData == null && decompressedSize == 0) {
        synchronized (mLockObject) {
            compressedData = mCompressedData;
            decompressedSize = mDecompressedSize;
            if (compressedData == null && decompressedSize == 0) {
                final byte[] decompressedData = marshall(mInstance);
                compressedData = compress(decompressedData);
                if (compressedData == null) {
                    decompressedSize = -1;
                    Slog.i(TAG, "Failed to compress data.");
                } else {
                    decompressedSize = decompressedData.length;
                }
                mDecompressedSize = decompressedSize;
                mCompressedData = compressedData;
            }
        }
    }
    if (compressedData != null && decompressedSize > 0) {
        dest.writeInt(mCount);
        dest.writeInt(decompressedSize);
        dest.writeByteArray(compressedData);
    } else {
        Slog.i(TAG, "Unexpected state. Behaving as an empty array.");
        dest.writeInt(0);
    }
}