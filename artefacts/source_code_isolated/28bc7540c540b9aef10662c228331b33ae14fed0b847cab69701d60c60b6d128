public final void init(SecureRandom random){
    if (serviceIterator == null) {
        spi.engineInit(random);
        return;
    }
    RuntimeException failure = null;
    KeyGeneratorSpi mySpi = spi;
    do {
        try {
            mySpi.engineInit(random);
            initType = I_RANDOM;
            initKeySize = 0;
            initParams = null;
            initRandom = random;
            return;
        } catch (RuntimeException e) {
            if (failure == null) {
                failure = e;
            }
            mySpi = nextSpi(mySpi, false);
        }
    } while (mySpi != null);
    throw failure;
}