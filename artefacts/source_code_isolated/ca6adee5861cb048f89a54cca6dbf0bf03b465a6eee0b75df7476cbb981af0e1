public boolean addPackage(String x_app_id, String content_type, String package_name, String class_name, int app_type, boolean need_signature, boolean further_processing){
    WapPushManDBHelper dbh = getDatabase(mContext);
    SQLiteDatabase db = dbh.getWritableDatabase();
    WapPushManDBHelper.queryData lastapp = dbh.queryLastApp(db, x_app_id, content_type);
    boolean ret = false;
    boolean insert = false;
    int sq = 0;
    if (!appTypeCheck(app_type)) {
        Log.w(LOG_TAG, "invalid app_type " + app_type + ". app_type must be " + WapPushManagerParams.APP_TYPE_ACTIVITY + " or " + WapPushManagerParams.APP_TYPE_SERVICE);
        return false;
    }
    if (lastapp == null) {
        insert = true;
        sq = 0;
    } else if (!lastapp.packageName.equals(package_name) || !lastapp.className.equals(class_name)) {
        insert = true;
        sq = lastapp.installOrder + 1;
    }
    if (insert) {
        ContentValues values = new ContentValues();
        values.put("x_wap_application", x_app_id);
        values.put("content_type", content_type);
        values.put("package_name", package_name);
        values.put("class_name", class_name);
        values.put("app_type", app_type);
        values.put("need_signature", need_signature ? 1 : 0);
        values.put("further_processing", further_processing ? 1 : 0);
        values.put("install_order", sq);
        db.insert(APPID_TABLE_NAME, null, values);
        if (LOCAL_LOGV)
            Log.v(LOG_TAG, "add:" + x_app_id + ":" + content_type + " " + package_name + "." + class_name + ", newsq:" + sq);
        ret = true;
    }
    db.close();
    return ret;
}