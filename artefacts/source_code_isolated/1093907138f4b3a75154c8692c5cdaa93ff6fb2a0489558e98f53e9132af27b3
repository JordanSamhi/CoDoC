public void updateAppWidgetSize(Bundle newOptions, int minWidth, int minHeight, int maxWidth, int maxHeight, boolean ignorePadding){
    if (newOptions == null) {
        newOptions = new Bundle();
    }
    Rect padding = getDefaultPadding();
    float density = getResources().getDisplayMetrics().density;
    int xPaddingDips = (int) ((padding.left + padding.right) / density);
    int yPaddingDips = (int) ((padding.top + padding.bottom) / density);
    int newMinWidth = minWidth - (ignorePadding ? 0 : xPaddingDips);
    int newMinHeight = minHeight - (ignorePadding ? 0 : yPaddingDips);
    int newMaxWidth = maxWidth - (ignorePadding ? 0 : xPaddingDips);
    int newMaxHeight = maxHeight - (ignorePadding ? 0 : yPaddingDips);
    AppWidgetManager widgetManager = AppWidgetManager.getInstance(mContext);
    Bundle oldOptions = widgetManager.getAppWidgetOptions(mAppWidgetId);
    boolean needsUpdate = false;
    if (newMinWidth != oldOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_WIDTH) || newMinHeight != oldOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_HEIGHT) || newMaxWidth != oldOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MAX_WIDTH) || newMaxHeight != oldOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MAX_HEIGHT)) {
        needsUpdate = true;
    }
    if (needsUpdate) {
        newOptions.putInt(AppWidgetManager.OPTION_APPWIDGET_MIN_WIDTH, newMinWidth);
        newOptions.putInt(AppWidgetManager.OPTION_APPWIDGET_MIN_HEIGHT, newMinHeight);
        newOptions.putInt(AppWidgetManager.OPTION_APPWIDGET_MAX_WIDTH, newMaxWidth);
        newOptions.putInt(AppWidgetManager.OPTION_APPWIDGET_MAX_HEIGHT, newMaxHeight);
        updateAppWidgetOptions(newOptions);
    }
}