public void writeImage(@NonNull OutputStream dngOutput, @NonNull Image pixels) throws IOException{
    if (dngOutput == null) {
        throw new IllegalArgumentException("Null dngOutput to writeImage");
    } else if (pixels == null) {
        throw new IllegalArgumentException("Null pixels to writeImage");
    }
    int format = pixels.getFormat();
    if (format != ImageFormat.RAW_SENSOR) {
        throw new IllegalArgumentException("Unsupported image format " + format);
    }
    Image.Plane[] planes = pixels.getPlanes();
    if (planes == null || planes.length <= 0) {
        throw new IllegalArgumentException("Image with no planes passed to writeImage");
    }
    ByteBuffer buf = planes[0].getBuffer();
    writeByteBuffer(pixels.getWidth(), pixels.getHeight(), buf, dngOutput, planes[0].getPixelStride(), planes[0].getRowStride(), 0);
}