public final void setPreviewCallbackWithBuffer(PreviewCallback cb){
    mPreviewCallback = cb;
    mOneShot = false;
    mWithBuffer = true;
    if (cb != null) {
        mUsingPreviewAllocation = false;
    }
    setHasPreviewCallback(cb != null, true);
}