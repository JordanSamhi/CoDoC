public Format[] getFormats(){
    Format[] resultArray = new Format[maxOffset + 1];
    System.arraycopy(formats, 0, resultArray, 0, maxOffset + 1);
    return resultArray;
}